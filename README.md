# Pico setup for Windows

[Download the latest release](https://github.com/ndabas/pico-setup-windows/releases)

This project aims to create an easy-to-use installer to get started on Windows (using the C/C++ SDK) with the [Raspberry Pi Pico](https://www.raspberrypi.org/products/raspberry-pi-pico/) microcontroller board, and possibly other RP2040-based boards as well. It is inspired by, and is roughly equivalent to, the [pico-setup](https://github.com/raspberrypi/pico-setup) project for Linux systems.

The installers automate the prerequisite installation on Windows, as explained in the official [Getting started with Raspberry Pi Pico](https://datasheets.raspberrypi.org/pico/getting-started-with-pico.pdf) guide. In addition, the installer offers to clone and build the Raspberry Pi Pico SDK for C/C++, along with some related repos which might be useful.

Documentation for end-users is in the [ReadMe.txt](docs/ReadMe.txt) file that is copied by the installer.

The installers attempt to install the required tools silently, without user intervention. The installers are configured with the recommended options from the official guide. For advanced users who wish to configure the software themselves, it might be better to download and install the software manually, or using a package manager.

## Included software

- [GNU Arm Embedded Toolchain](https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm/downloads) - the official guide refers to this as "ARM GCC Compiler"
- [CMake](https://cmake.org/download/)
- [Build Tools for Visual Studio 2019](https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2019)
- [Python 3.9](https://www.python.org/downloads/windows/)
- [Git for Windows](https://git-scm.com/download/win)
- [Visual Studio Code](https://code.visualstudio.com/)
- [OpenOCD with picoprobe support](https://github.com/raspberrypi/openocd)
- [Zadig](https://zadig.akeo.ie/)
- [Doxygen](https://www.doxygen.nl/download.html)
- [Graphviz](https://graphviz.org/download/)

# Building

The installers are built with [NSIS 3](https://nsis.sourceforge.io/Download). The NSIS script is generated by [build.ps1](build.ps1) when provided with a JSON configuration file. The build script automatically downloads a local copy of NSIS to use for the build.

Configuration files for x86 (32-bit) and x64 (64-bit) builds are provided.

Compiling OpenOCD requires an installation of [MSYS2](https://www.msys2.org/). The build script automatically downloads and installs a local copy of MSYS2. You can specify a path to an existing copy of MSYS2 using the `-MSYS2Path` option. The build script will install a copy of MSYS2 at this path if it doesn't find an existing copy.

It is highly recommended to use a dedicated copy of MSYS2 for this build.

To build:

```powershell
.\build.ps1 .\x64.json -MSYS2Path ~\Downloads\msys64
.\build.ps1 .\x86.json -MSYS2Path ~\Downloads\msys64
```

The built installers will be saved to the `bin` directory.

# Tests

There are tests for some parts of the build scripts. You can run them like this:

```powershell
Install-Module Pester -Force
Import-Module Pester -PassThru # Check the version of the imported module -- we need v5 or greater
Invoke-Pester -Output Detailed
```

# Credits

[RefreshEnv.cmd](RefreshEnv.cmd) is from [Chocolatey](https://github.com/chocolatey/choco/blob/master/src/chocolatey.resources/redirects/RefreshEnv.cmd).
